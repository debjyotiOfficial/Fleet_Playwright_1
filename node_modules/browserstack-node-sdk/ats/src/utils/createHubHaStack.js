const a28_0x3bf51c=a28_0x13a4;(function(_0x39a97d,_0x531c6b){const _0x58a2fb=a28_0x13a4,_0xe38d3b=_0x39a97d();while(!![]){try{const _0x3c2f46=parseInt(_0x58a2fb(0x13f))/0x1+-parseInt(_0x58a2fb(0x11c))/0x2*(parseInt(_0x58a2fb(0x149))/0x3)+parseInt(_0x58a2fb(0x113))/0x4+-parseInt(_0x58a2fb(0x115))/0x5+-parseInt(_0x58a2fb(0x11e))/0x6*(parseInt(_0x58a2fb(0x13c))/0x7)+-parseInt(_0x58a2fb(0x12a))/0x8*(parseInt(_0x58a2fb(0x133))/0x9)+parseInt(_0x58a2fb(0x13e))/0xa;if(_0x3c2f46===_0x531c6b)break;else _0xe38d3b['push'](_0xe38d3b['shift']());}catch(_0x16a072){_0xe38d3b['push'](_0xe38d3b['shift']());}}}(a28_0x5784,0x8dd5b));function a28_0x13a4(_0x44c43b,_0x2675db){const _0x57849f=a28_0x5784();return a28_0x13a4=function(_0x13a439,_0x355d4b){_0x13a439=_0x13a439-0x113;let _0x29712e=_0x57849f[_0x13a439];return _0x29712e;},a28_0x13a4(_0x44c43b,_0x2675db);}const fs=require('fs'),path=require('path'),Promise=require(a28_0x3bf51c(0x14a)),yaml=require(a28_0x3bf51c(0x122)),{CLOUDFORMATION_SCHEMA}=require(a28_0x3bf51c(0x14d)),AWS=require(a28_0x3bf51c(0x118))[a28_0x3bf51c(0x139)],AWSUtils=require('./AWSUtils'),{CLUSTER_HUB_HA_STACK_NAME,COMMON_HST_TAGS}=require('../config/constants'),{logger}=require('../config/logger');Promise['promisifyAll'](fs);function a28_0x5784(){const _0x428579=['join','ZAFHH','getOidcUrl','browserstack:cluster','CFTemplates','264pmSoJU','createHubHaStack','ClusterOIDCURL','DYdLc','valueOf','push','Parameters','Resources','-cf','115884nHXstL','2010-05-15','LmPht','split','Capabilities','StackId','awsObj','jixeT','qdBtW','40061lUQjoV','LKcIy','8982430yhxWmR','1093857GRWFvL','promise','stackCreateComplete','Key','CAPABILITY_NAMED_IAM','load','toString','svrXN','Waiting\x20for\x20CloudFormation\x20stack\x20to\x20complete','waitFor','125337AhqSbx','bluebird','apiVersion','bQPVp','js-yaml-cloudformation-schema','createStack','TemplateBody','2492968pYVhZv','hHLTm','4713665lvWIaT','OnFailure','stringify','./AWSUtils','readFileAsync','Properties','BaseResourceName','30HdIybZ','Tags','42SFkbqJ','zyLcT','utf-8','StackName','js-yaml','://','schema'];a28_0x5784=function(){return _0x428579;};return a28_0x5784();}const addTags=async(_0x555f43,_0x2116dc)=>{const _0x5f5910=a28_0x3bf51c;for(const _0x10bbc8 in _0x555f43['Resources']){_0x555f43[_0x5f5910(0x131)][_0x10bbc8]['Properties']&&_0x555f43[_0x5f5910(0x131)][_0x10bbc8][_0x5f5910(0x11a)][_0x5f5910(0x11d)]&&_0x555f43[_0x5f5910(0x131)][_0x10bbc8][_0x5f5910(0x11a)][_0x5f5910(0x11d)][_0x5f5910(0x12f)](..._0x2116dc);}};exports[a28_0x3bf51c(0x12b)]=async(_0x23c510,_0x99fe78=null)=>{const _0x1d6584=a28_0x3bf51c,_0x25c908={'ZAGWt':_0x1d6584(0x128),'iAgMM':'browserstack:creationDate','svrXN':_0x1d6584(0x134),'XYkkd':_0x1d6584(0x129),'ZAFHH':'hub-ha.yaml','Ohney':_0x1d6584(0x120),'LKcIy':function(_0x585da5,_0x4cd813,_0x411407){return _0x585da5(_0x4cd813,_0x411407);},'jixeT':_0x1d6584(0x123),'DYdLc':'DELETE','bQPVp':'VpcId','hHLTm':_0x1d6584(0x11b),'qdBtW':_0x1d6584(0x12c),'LmPht':_0x1d6584(0x143),'zyLcT':_0x1d6584(0x147),'rofyT':_0x1d6584(0x141)},_0x37a1d4=COMMON_HST_TAGS,_0x2d3b07={};_0x2d3b07[_0x1d6584(0x142)]=_0x25c908['ZAGWt'],_0x2d3b07['Value']=_0x23c510,_0x37a1d4['push'](_0x2d3b07),_0x37a1d4['push']({'Key':_0x25c908['iAgMM'],'Value':new Date()[_0x1d6584(0x12e)]()[_0x1d6584(0x145)]()});const _0x2e5265={};_0x2e5265[_0x1d6584(0x14b)]=_0x25c908[_0x1d6584(0x146)];const _0x1825b6=new AWS['CloudFormation'](_0x2e5265),_0x3a38a1=await fs[_0x1d6584(0x119)](path[_0x1d6584(0x125)](__dirname,'..',_0x25c908['XYkkd'],_0x25c908[_0x1d6584(0x126)]),_0x25c908['Ohney']),_0x4434d1={};_0x4434d1[_0x1d6584(0x124)]=CLOUDFORMATION_SCHEMA;const _0x9b1d90=yaml[_0x1d6584(0x144)](_0x3a38a1,_0x4434d1);await _0x25c908[_0x1d6584(0x13d)](addTags,_0x9b1d90,_0x37a1d4);const _0x1a0569=JSON[_0x1d6584(0x117)](_0x9b1d90);let _0x599f96=await AWSUtils[_0x1d6584(0x127)](_0x23c510);_0x599f96=_0x599f96[_0x1d6584(0x136)](_0x25c908[_0x1d6584(0x13a)])[0x1];const _0x1c3ca9={};_0x1c3ca9[_0x1d6584(0x121)]=CLUSTER_HUB_HA_STACK_NAME+'-'+_0x23c510+_0x1d6584(0x132),_0x1c3ca9[_0x1d6584(0x116)]=_0x25c908[_0x1d6584(0x12d)],_0x1c3ca9[_0x1d6584(0x14f)]=_0x1a0569,_0x1c3ca9[_0x1d6584(0x130)]=[{'ParameterKey':_0x25c908[_0x1d6584(0x14c)],'ParameterValue':_0x99fe78},{'ParameterKey':_0x25c908[_0x1d6584(0x114)],'ParameterValue':CLUSTER_HUB_HA_STACK_NAME+'-'+_0x23c510},{'ParameterKey':_0x25c908[_0x1d6584(0x13b)],'ParameterValue':_0x599f96}],_0x1c3ca9[_0x1d6584(0x137)]=[_0x25c908[_0x1d6584(0x135)]],_0x1c3ca9[_0x1d6584(0x11d)]=_0x37a1d4;const _0x2aecbb=_0x1c3ca9,_0x124f42=await _0x1825b6[_0x1d6584(0x14e)](_0x2aecbb)[_0x1d6584(0x140)]();logger['info'](_0x25c908[_0x1d6584(0x11f)]);const _0x4baf82={};return _0x4baf82[_0x1d6584(0x121)]=_0x124f42[_0x1d6584(0x138)],_0x1825b6[_0x1d6584(0x148)](_0x25c908['rofyT'],_0x4baf82)[_0x1d6584(0x140)]();};